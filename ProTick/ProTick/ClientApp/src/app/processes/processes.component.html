<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

<body>
  <button mat-raised-button (click)="openCreateProcessDialog()">Prozess erstellen</button>

  <br />
  <br />

  <mat-form-field>
    <mat-label>Prozess</mat-label>
    <mat-select [(ngModel)]="selectedProcess" (selectionChange)="getSubprocessesByProcessID(selectedProcess)">
      <mat-option *ngFor="let process of processes" [value]="process.processID">
        {{process.description}}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <button mat-raised-button (click)="openCreateSubprocessDialog()">Subprozess erstellen</button>

  <br />
  <br />

  <div class="mat-elevation-z8 table_container">
    <table mat-table #tableFirst [dataSource]="firstSubprocess">
      <tr mat-header-row *matHeaderRowDef="firstDisplayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: firstDisplayedColumns;"></tr>

      <ng-container matColumnDef="firstSubprocessID">
        <th mat-header-cell *matHeaderCellDef> ID </th>
        <td mat-cell *matCellDef="let element">{{element.subprocessID}} </td>
      </ng-container>

      <ng-container matColumnDef="firstDescription">
        <th mat-header-cell *matHeaderCellDef> Beschreibung </th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field floatLabel=never>
            <input matInput [(ngModel)]="element.description" placeholder="Beschreibung" (change)="attributeChanged(element.subprocessID, 'description', element.description);" />
          </mat-form-field>
        </td>
      </ng-container>

      <ng-container matColumnDef="firstTeamName">
        <th mat-header-cell *matHeaderCellDef> Team </th>
        <td mat-cell *matCellDef="let element">

          <mat-form-field floatLabel=never>
            <mat-label>Team</mat-label>
            <mat-select [(ngModel)]="element.teamID" (selectionChange)="attributeChanged(element.subprocessID, 'teamID', element.teamID)">
              <mat-option *ngFor="let team of teams" [value]="team.teamID">
                {{team.abbreviation}}
              </mat-option>
            </mat-select>
          </mat-form-field>

        </td>
      </ng-container>

      <ng-container matColumnDef="childProcesses">
        <th mat-header-cell *matHeaderCellDef> Kindprozesse </th>
        <td mat-cell *matCellDef="let element">
          <span>{{getFormatedChildrenOf(element)}}</span>
        </td>
      </ng-container>


      <ng-container matColumnDef="childOptions">
        <th mat-header-cell *matHeaderCellDef>  </th>
        <td mat-cell *matCellDef="let element">
          <button mat-mini-fab (click)="openEditChildSubprocessesDialog(element)"><mat-icon aria-hidden="false" aria-label="Bearbeiten">more_horiz</mat-icon></button>
        </td>
      </ng-container>
    </table>
  </div>

  <br />
  <br />

  <div class="mat-elevation-z8 table_container">
    <table mat-table #table [dataSource]="displayedSubprocesses">

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <ng-container matColumnDef="subprocessID">
        <th mat-header-cell *matHeaderCellDef> ID </th>
        <td mat-cell *matCellDef="let element">{{element.subprocessID}} </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef> Beschreibung </th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field floatLabel=never>
            <input matInput [(ngModel)]="element.description" placeholder="Beschreibung" (change)="attributeChanged(element.subprocessID, 'description', element.description);" />
          </mat-form-field>
        </td>
      </ng-container>

      <ng-container matColumnDef="teamName">
        <th mat-header-cell *matHeaderCellDef> Team </th>
        <td mat-cell *matCellDef="let element">

          <mat-form-field floatLabel=never>
            <mat-label>Team</mat-label>
            <mat-select [(ngModel)]="element.teamID" (selectionChange)="attributeChanged(element.subprocessID, 'teamID', element.teamID)">
              <mat-option *ngFor="let team of teams" [value]="team.teamID">
                {{team.abbreviation}}
              </mat-option>
            </mat-select>
          </mat-form-field>

        </td>
      </ng-container>

      <ng-container matColumnDef="childProcesses">
        <th mat-header-cell *matHeaderCellDef> Kindprozesse </th>
        <td mat-cell *matCellDef="let element">
          <span>{{getFormatedChildrenOf(element)}}</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="childOptions">
        <th mat-header-cell *matHeaderCellDef>  </th>
        <td mat-cell *matCellDef="let element">
          <button mat-mini-fab (click)="openEditChildSubprocessesDialog(element)"><mat-icon aria-hidden="false" aria-label="Bearbeiten">more_horiz</mat-icon></button>
        </td>
      </ng-container>


      <ng-container matColumnDef="optionButtons">
        <th mat-header-cell *matHeaderCellDef>  </th>
        <td mat-cell *matCellDef="let element">
          <button mat-raised-button (click)="useAsFirst(element.subprocessID)" [disabled]="serviceWorking">Use As First!</button>
        </td>
      </ng-container>
    </table>
  </div>
</body>
